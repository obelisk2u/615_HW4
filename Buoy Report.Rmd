Include:
```{r}
library(data.table)
library(dplyr)
library(lubridate)
library(ggplot2)
```




READ IN DATA
```{r}
file_root<-"https://www.ndbc.noaa.gov/view_text_file.php?filename=44013h"
year_num<-"1985"
year<-as.character(seq(1986,2023))
tail<- ".txt.gz&dir=data/historical/stdmet/"
path<-paste0(file_root,year_num,tail)
header=scan(path,what= 'character',nlines=1)
buoy<-fread(path,header=FALSE,skip=2)
colnames(buoy)<-header

for (i in 1:length(year)){
  year_num = year[i]
  path<-paste0(file_root, year_num, tail)
  tmp<-fread(path,header=FALSE,skip=2, showProgress=FALSE)
  buoy<-rbind(buoy, tmp, use.names=FALSE, fill=TRUE)
}
```


CLEAN DATA
```{r}
#if you run distinct on both they dont include anything other than NA or 99 so we can remove these columns completely 
buoy<-subset(buoy, select = -V17)
buoy<-subset(buoy, select = -V18)

#set all trash data to NA
buoy$VIS<-ifelse(buoy$VIS==99, NA, buoy$VIS)
buoy$DEWP<-ifelse(buoy$DEWP==999, NA, buoy$DEWP)
buoy$MWD<-ifelse(buoy$MWD==999, NA, buoy$MWD)
buoy$APD<-ifelse(buoy$APD==99, NA, buoy$APD)
buoy$DPD<-ifelse(buoy$DPD==99, NA, buoy$DPD)
buoy$WVHT<-ifelse(buoy$WVHT==99, NA, buoy$WVHT)
buoy$BAR<-ifelse(buoy$BAR==999, NA, buoy$BAR)

#Add new datetime column
buoy$datetime <- ymd_h(paste(buoy$YY, buoy$MM, buoy$DD, buoy$hh, sep = "-"))
```

VIS NA Explanation
```{r}
#create vector over time that specifies whether the VIS index has a data reading or and NA
VIS_cat<-ifelse(is.na(buoy$VIS), "N/A", "Has Data")

#plot this vector versus time 
ggplot(buoy, aes(x = datetime, y = VIS_cat)) +
  geom_point() +
  labs(x = "Time", y = "Category", title = "Values for VIS: NA vs. Everything Else")
```

I was interested in learning more about the distribution of NAs in VIS (visibility) observations. Initially I figured that visibility value was calculated through photos, leading me to expect data to begin to appear when satelite bandwidth improved enough to be able to handle photos. Instead I discovered that the buoys calculate visibility through a series of calculations including wind speed, direction, humidity, temperature, and other factors. I also did some research and learned that NDBC implemented cameras in 2018. Both of these realizations determined that there must be another explanation to the distribution of NA data. 

My personal theory is that they had an initial test of including visibility data between ~1994-1996. Then, whether due to a lack of funding, or degradation of 90's quality hardware they stopped including it. Then, as the transfer of data got cheaper and hardware increased in quality they booted back up visibility readings ~2005. The explanation as to why there is also NAs in that time period of early visibility readings is visibility data wasn't read as often as other factors leaving the VIS data to be empty.  

```{r}

```


















